$.extend(Array.prototype,{indexOf:function(c){for(var b=0,a=this.length;b<a;b++){if(FR.equals(c,this[b])){return b}}return -1},lastIndexOf:function(c){for(var a=this.length,b=a-1;b>=0;b--){if(FR.equals(c,this[b])){return b}}return -1},remove:function(b){var a=this.indexOf(b);if(a!=-1){this.splice(a,1)}return this},clear:function(){while(this.length>0){this.pop()}}});(function(){$.fn.swapClass=function(b,a){return b==undefined?this.removeClass().addClass(a):this.removeClass(b).addClass(a)};$.fn.switchClass=function(b,a){if(this.hasClass(b)){return(a||a===0)?this.swapClass(b,a):false
}else{return this.swapClass(a,b)}};$.fn.isChildOf=function(a){var c=this;var e=c[0];var d=a[0];var f=e.parentNode;while(f){if(f==d){return true}else{if(!f.tagName||f.tagName.toUpperCase()=="HTML"){return false}}f=f.parentNode}return false};$.fn.isChildAndSelfOf=function(a){return(this.closest(a).length>0)};$.extend($.Event.prototype,{stopEvent:function(){this.stopPropagation();this.preventDefault()}})})();$.extend(String,{escape:function(a){return a.replace(/('|\\)/g,"\\$1")},leftPad:function(d,b,c){var a=String(d);
if(!c){c=" "}while(a.length<b){a=c+a}return a.toString()},format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})}});$.extend(String.prototype,{startWith:function(a){if(a==null||a==""||this.length===0||a.length>this.length){return false}return this.substr(0,a.length)==a},endWith:function(a){if(a==null||a==""||this.length===0||a.length>this.length){return false}return this.substring(this.length-a.length)==a},getQuery:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");
var c=this.substr(this.indexOf("?")+1).match(b);if(c){return unescape(c[2])}return null},appendQuery:function(a){if(!a){return this}var b=this;if(b.indexOf("?")===-1){b+="?"}if(b.endWith("?")!==false){}else{b+="&"}$.each(a,function(c,d){if(typeof(c)==="string"){b+=c+"="+d+"&"}});b=b.substr(0,b.length-1);return b},replaceAll:function(b,a){return this.replace(new RegExp(b,"gm"),a)},perfectStart:function(a){if(this.startWith(a)){return this}else{return a+this}},allIndexOf:function(b){if(typeof b!="string"){return[]
}var e=this;var a=[];var d=0;while(e.length>0){var c=e.indexOf(b);if(c===-1){break}a.push(d+c);e=e.substring(c+b.length,e.length);d+=c+b.length}return a}});$.extend(Function.prototype,{createCallback:function(){var a=arguments;var b=this;return function(){return b.apply(window,a)}},createDelegate:function(c){var d=this;var b=arguments[1];var a=arguments[2];return function(){var f=b||arguments;if(a===true){f=Array.prototype.slice.call(arguments,0);f=f.concat(b)}else{if(typeof a=="number"){f=Array.prototype.slice.call(arguments,0);
var e=[a,0].concat(b);Array.prototype.splice.apply(f,e)}}return d.apply(c||window,f)}},createInterceptor:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){b.target=this;b.method=c;if(b.apply(a||this||window,arguments)===false){return}return c.apply(this||window,arguments)}},defer:function(c,e,b,a){var d=this.createDelegate(e,b,a);if(c||c===0){return setTimeout(d,c)}d();return 0},createSequence:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){var d=c.apply(this||window,arguments);
b.apply(a||this||window,arguments);return d}},getNameArguments:function(){var d=this.toString();var c=/function[^\(]*\(([^\)]*)\)/.exec(d);var b=[];if(c!=null){b=c[1].split(",")}return $.map(b,function(a){return $.trim(a)})},arguments2Json:function(){var a=arguments;var b=this.getNameArguments();var c={};$.each(b,function(d,e){if(a.length>d){c[e]=a[d]}});return c}});if(window.FR==null){window.FR={}}(function(){$.extend(FR,{cjkEncodeDO:function(b){if($.isPlainObject(b)){var a={};$.each(b,function(d,c){if(!(typeof c=="string")){c=FR.jsonEncode(c)
}d=FR.cjkEncode(d);a[d]=FR.cjkEncode(c)});return a}return b},ajax:function(a){if(a){a.data=FR.cjkEncodeDO(a.data)}$.ajax(a)},get:function(a,c,d,b){if($.isFunction(c)){b=b||d;d=c;c=undefined}if(c){c=FR.cjkEncodeDO(c)}$.get(a,c,d,b)},post:function(a,c,d,b){if($.isFunction(c)){b=b||d;d=c;c=undefined}if(c){c=FR.cjkEncodeDO(c)}$.post(a,c,d,b)},param:function(b){b=FR.cjkEncodeDO(b);return $.param(b)},url:function(a,b){if($.isPlainObject(b)){return a+"?"+FR.param(b)}return FR.cjkEncode(a)},buildServletUrl:function(b,a){if(a){b=$.extend({_:(""+new Date().getTime())},b)
}return FR.url(FR.servletURL,b)},resource:function(a){return FR.buildServletUrl({op:"resource",resource:a})},tc:function(b,a){try{return b.call(a)}catch(c){FR.Msg.toast(c.toString());throw c}},pick:function(){var a,c=arguments.length;for(var b=0;b<c;b++){a=arguments[b];if(typeof a!=="undefined"&&a!==null){return a}}return null}})})();(function(){$.extend(FR,{formulaEvaluator:function(d,b,a){var c=b;return function(f){if(f||c==undefined||a){try{if(FR.SessionMgr.getSessionID()){c=FR.remoteEvaluate(d)
}}catch(g){}}return c}},remoteEvaluate:function(b){var a=null;b=encodeURIComponent(b);FR.ajax({url:FR.servletURL,type:"POST",async:false,data:{op:"fr_base",cmd:"evaluate_formula",sessionID:FR.SessionMgr.getSessionID(),expression:b},timeout:5000,complete:function(d,c){a=FR.jsonDecode(d.responseText);a=a.result}});return a}})})();(function($){var COL_IDS="ABCDEFGHIJKLMNOPQRSTUVWXYZ";$.extend(FR,{limitData:500,constant:{success:"success",failure:"failure"},emptyFn:function(){},isWidthOrHeight:function(o){if(typeof o=="number"){return o>=0
}else{if(typeof o=="string"){return/^\d{1,3}%$/.exec(o)||o=="auto"||/^\d+px$/.exec(o)}}},number2Percentage:function(number){return(~~(number*100))+"%"},isArray:function(a){return Object.prototype.toString.call(a)=="[object Array]"||a instanceof jQuery},applyStyles:function($el,styles){if(styles){if(typeof styles=="string"){var re=/\s?([a-z\-]*)\:\s?([^;]*);?/gi;var matches;while((matches=re.exec(styles))!=null){$el.css(matches[1],matches[2])}}else{if(typeof styles=="object"){$el.css(styles)}else{if(typeof styles=="function"){FR.applyStyles(dom,styles.call())
}}}}},showMenuByEvent:function(o,evt,evtPosition){if(evtPosition===true){FR.showMenuByLocation(o,{left:evt.clientX,top:evt.clientY},{left:-2,top:-2})}else{if(evt.target){FR.showMenuByEl(o,$(evt.target))}else{FR.showMenuByLocation(o,{left:evt.clientX,top:evt.clientY+10})}}},isEmptyArray:function(array){if($.isArray(array)){if(array.length===0){return true}else{if(array.length===1){return array[0]===""}}}return false},applyFunc:function(obj,func,param,defaultValue){if((typeof func)=="function"){return func.apply(obj,param?param:[])
}return defaultValue},encodePrecentPlus:function(s){if(typeof(s)=="string"){s=s.replace(/%/gi,"%25");s=s.replace(/\+/gi,"%2B")}else{if(FR.isArray(s)){for(var i=0;i<s.length;i++){s[i]=FR.encodePrecentPlus(s[i])}}}return s},showMenuByEl:function(o,$el){var menu;if($el.fr_menu&&$el.fr_menu.menu&&(FR.equals($.extend({xxxMMenu:true},o),$el.fr_menu.opts)||$el.fr_menu.menu.close())){menu=$el.fr_menu.menu}else{o.$el=$el;menu=FR.createShortMenu(o);delete o.$el}var modify=1;if($el.offset().top<menu.$menuRoot.height()+modify||$el.offset().top+$el.height()+modify+menu.$menuRoot.height()<document.body.clientHeight){var offsetTop=$el.offset().top+$el.height()+modify
}else{var offsetTop=$el.offset().top-menu.$menuRoot.height()-modify}o.xxxMMenu=true;menu.show();menu.position($el.offset().left,offsetTop);$el.fr_menu={menu:menu,opts:o}},showMenuByLocation:function(o,location,modify){if(!modify){modify={left:0,top:0}}var menu=FR.createShortMenu(o);FR.showWithMenu(menu,location,modify)},showWithMenu:function(menu,location,modify){if(location.left<menu.$menuRoot.width()+modify.left||location.left+modify.left+menu.$menuRoot.width()<document.body.clientWidth){var left=location.left+modify.left
}else{var left=location.left-menu.$menuRoot.width()-modify.left}if(location.top<menu.$menuRoot.height()+modify.top||location.top+modify.top+menu.$menuRoot.height()<document.body.clientHeight){var top=location.top+modify.top}else{var top=location.top-menu.$menuRoot.height()-modify.top}menu.show();left=$.browser.msie?left-5:left;top=$.browser.msie?top-5:top;menu.position(left,top)},versionRemind:function(o){var jo=FR.jsonDecode(o);if(jo.exception=="failpass"){var msg=FR.i18nText("FailPass_ImproveYourVersion");
if(jo.func){msg=jo.func+", "+msg}FR.Msg.toast(msg);return false}return true},createShortMenu:function(o){o=$.extend({minWidth:80,destroyOnClose:true},o);return new FR.frMenu(o)},doHyperlink:function(){function _doHyperlink(data){new Function(unescape(data))()}return function(evt,obj,evtPosition){if($.isArray(obj)){switch(obj.length){case 0:return;case 1:FR.doHyperlink(evt,obj[0]);break;default:var relatedChartHyperlink=[];var otherHyperlink=[];for(var i=0;i<obj.length;i++){if(obj[i].data&&obj[i].data.indexOf("chart_Change_Parameter")>=0){relatedChartHyperlink[relatedChartHyperlink.length]=obj[i]
}else{otherHyperlink[otherHyperlink.length]=obj[i]}}for(var i=0;i<relatedChartHyperlink.length;i++){_doHyperlink(relatedChartHyperlink[i].data)}switch(otherHyperlink.length){case 0:return;case 1:FR.doHyperlink(evt,otherHyperlink[0]);break;default:FR.showMenuByEvent({items:$.map(otherHyperlink,function(cfg){return{src:cfg.name,handler:_doHyperlink.createCallback(cfg.data)}})},evt,evtPosition||false)}}}else{_doHyperlink(obj.data)}}}(),doHyperlinkByGet:function(url,para,target,feature){para=$.extend({_:new Date().getTime()},para);
var pString="";var paras={};$.each(para,function(pName,pValue){if(FR.isArray(pValue)&&!FR.isEmptyArray(pValue)&&FR.isArray(pValue[0])){pValue=pValue.join(";")}var tmpName=FR.cjkDecode(pName);var tmpValue=FR.cjkDecode(pValue);paras[pName]=pValue;if(tmpName!="__LOCALE__"&&tmpName!="REPORTLET"&&tmpName!="OP"){pString+="&"+encodeURIComponent(encodeURIComponent(tmpName))+"="+encodeURIComponent(encodeURIComponent(tmpValue))}});if(url.indexOf("?")==-1){url+="?";pString=pString.substring(1)}if(FR.MobileTools.openLink(url,target,pString)){return
}if(target&&target=="_dialog"){this.showHyperlinkDialog(url+pString,feature)}else{var targetUrl=url+pString;if(targetUrl.length>=2048&&$.browser.msie){var submitForm=$("<form method='post' target='"+target+"' action='"+url+"'></form>").hide().appendTo($("body"));for(var i in paras){$('<input type="hidden" name="'+i+'" value=""/>').attr("value",paras[i]).appendTo(submitForm)}submitForm.submit()}else{window.open(targetUrl,target)}}},showHyperlinkDialog:function(url,feature){var isIEUnder8=$.browser.msie&&$.browser.version<9;
var iframeWidth=isIEUnder8?"99%":"100%";var iframeHeight=isIEUnder8?"99%":"100%";var iframeDialog="<iframe src='' width="+iframeWidth+" height= "+iframeHeight+" scrolling='no' frameborder='0'></iframe>";iframeDialog=$(iframeDialog).attr("src",url)[0];if(feature.split(",").length>2){var width=feature.split(",")[0];if(width.indexOf("=")!=-1){width=width.substring(width.indexOf("=")+1,width.length)}var height=feature.split(",")[1];if(height.indexOf("=")!=-1){height=height.substring(height.indexOf("=")+1,height.length)
}}FR.showDialog(" ",parseInt(width)||600,parseInt(height)||400,iframeDialog)},doHyperlinkByGet4Reportlet:function(url,para,target,feature){para=$.extend({_:new Date().getTime()},para);$.each(para,function(pName,pValue){if(pName!="__LOCALE__"&&pName!="REPORTLET"&&pName!="OP"&&!$.isPlainObject(pValue)){if(FR.isArray(pValue)){para[pName]=pValue}else{para[pName]=encodeURIComponent(encodeURIComponent(pValue))}}});var pString="__parameters__="+FR.cjkEncode(FR.jsonEncode(para));url+=url.indexOf("?")==-1?"?":"&";
if(FR.MobileTools.openLink(url,target,pString)){return}if(target&&target=="_dialog"){this.showHyperlinkDialog(url+pString,feature)}else{window.open(url+pString,target)}},doHyperlinkByPost:function(url,para,target,feature){var isGet=target&&target=="_dialog";$.each(para,function(pName,pValue){if(pName!="__LOCALE__"&&pName!="REPORTLET"&&pName!="OP"&&!$.isPlainObject(pValue)){if(FR.isArray(pValue)){para[pName]=pValue}else{para[pName]=isGet?encodeURIComponent(encodeURIComponent(pValue)):encodeURIComponent(pValue)
}}});if(this.$hyperlinkForm){this.$hyperlinkForm.html("")}else{this.$hyperlinkForm=($("<div>").appendTo($(document.body))).css({display:"none",position:"absolute"})}if(target==null){target="formresult"}para=FR.cjkEncode(FR.jsonEncode(para));var submitForm=$("<form method='post' target='"+target+"' action='"+url+"'></form>").appendTo(this.$hyperlinkForm);var input=$('<input type="hidden" name="__parameters__" value=""/>');input.attr("value",para);submitForm.append(input);if(isGet){var pString="__parameters__="+para;
url+=url.indexOf("?")==-1?"?":"&";this.showHyperlinkDialog(url+pString,feature)}else{submitForm.submit()}},isEmpty:function(value){var result=value===""||value===null||value===undefined;return result},toRE:function(str){return str.replace(/\\/g,"\\\\").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\{/g,"\\{").replace(/\}/g,"\\}").replace(/\*/g,"\\*").replace(/\|/g,"\\|").replace(/\?/g,"\\?").replace(/\$/g,"\\$").replace(/\^/g,"\\^")},_executeScriptFromHtml:function(html){},extend:function(){return function(sb,sp,overrides){if(typeof sp=="object"){overrides=sp;
sp=sb;sb=function(){sp.apply(this,arguments)}}var F=function(){},spp=sp.prototype;F.prototype=spp;sb.prototype=new F();sb.superclass=spp;$.extend(sb.prototype,overrides);return sb}}(),SessionMgr:function(){var sid,cp;$(window).unload(function(){$(window).unbind("unload",arguments.callee);if(sid&&cp&&FR.servletURL&&cp.rtype!="preview"&&cp.rtype!="bi"&&!cp.noClossSession){var closeSession=function(sid){FR.ajax({async:false,url:FR.servletURL,data:{op:"closesessionid",sessionID:sid}})};closeSession(sid)
}});if(FR.shouldSendHeartBeat){setInterval(function(){if(sid&&cp&&FR.servletURL){FR.ajax({url:FR.servletURL,data:{sessionID:sid,_:new Date().getTime()}})}},30000)}return{getSessionID:function(){return sid},getContentPane:function(){return cp},get:function(){return cp},register:function(id,s){sid=id;cp=s}}}(),CookieInfor:{getCookies:function(){var cookieString=document.cookie;return unescape(cookieString).split(";")},addCookie:function(name,value,temp){var newCookie=name+"="+escape(value);if(!temp){var expires=new Date();
expires.setTime(expires.getTime()+(30*24*3600*1000));newCookie+=";expires="+expires.toGMTString()}document.cookie=newCookie},removeCookie:function(name){var expires=new Date();expires.setTime(expires.getTime()-1);document.cookie=name+"=;expires="+expires.toGMTString()},clearCookie:function(){var self=this;var $cookies=this.getCookies();$.each($cookies,function(i){var cookieName=$cookies[i].split("=")[0];self.removeCookie(cookieName)})},getCookieByName:function(name){var $cookies=this.getCookies();
var re=new RegExp(name);var value=null;$.each($cookies,function(i){if($cookies[i].match(re)){value=$cookies[i].split(name+"=")[1];return false}});return value}},cjkEncode:function(text){if(typeof text!=="string"){return text}var newText="";for(var i=0;i<text.length;i++){var code=text.charCodeAt(i);if(code>=128||code===91||code===93){newText+="["+code.toString(16)+"]"}else{newText+=text.charAt(i)}}return newText},cjkDecode:function(text){if(text==null){return""}if(!isNaN(text)||text.indexOf("[")==-1){return text
}var newText="";for(var i=0;i<text.length;i++){var ch=text.charAt(i);if(ch=="["){var rightIdx=text.indexOf("]",i+1);if(rightIdx>i+1){var subText=text.substring(i+1,rightIdx);if(subText.length>0){ch=String.fromCharCode(eval("0x"+subText))}i=rightIdx}}newText+=ch}return newText},htmlSpaceDecode:function(text){return(text==null)?"":String(text).replace(/&nbsp;/," ")},htmlEncode:function(text){return(text==null)?"":String(text).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")
},htmlDecode:function(text){return(text==null)?"":String(text).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ")},jsonEncode:function(o){var useHasOwn={}.hasOwnProperty?true:false;var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)
})+'"'}return'"'+s+'"'};var encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(v===null?"null":FR.jsonEncode(v));b=true}}a.push("]");return a.join("")};if(typeof o=="undefined"||o===null){return"null"}else{if($.isArray(o)){return encodeArray(o)}else{if(o instanceof Date){return FR.jsonEncode({__time__:o.getTime()})}else{if(typeof o=="string"){return encodeString(o)}else{if(typeof o=="number"){return isFinite(o)?String(o):"null"
}else{if(typeof o=="boolean"){return String(o)}else{if($.isFunction(o)){return String(o)}else{var a=["{"],b,i,v;for(i in o){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"unknown":break;default:if(b){a.push(",")}a.push(FR.jsonEncode(i),":",v===null?"null":FR.jsonEncode(v));b=true}}}a.push("}");return a.join("")}}}}}}}},jsonDecode:function(text){try{var jo=$.parseJSON(text);if(jo==null){jo={}}}catch(e){try{jo=new Function("return "+text)()||{}}catch(e){}if(jo==null){jo=[]
}}if(!FR._hasDateInJson(text)){return jo}return(function(o){if(typeof o==="string"){return o}if(o&&o.__time__!=null){return new Date(o.__time__)}for(var a in o){if(o[a]==o||typeof o[a]=="object"||$.isFunction(o[a])){break}o[a]=arguments.callee(o[a])}return o})(jo)},_hasDateInJson:function(json){if(!json||typeof json!=="string"){return false}return json.indexOf("__time__")!=-1},setBackground:function($dom,bg,height){var type=bg.type;if((type===4||type===2)&&$.browser.msie){if(FR.ieForFixBackground()){var url=bg.url;
var bgImage=$("<img src='"+url+"' id='para-bg'>");bgImage.appendTo($dom);setSize($dom);$(window).resize(function(){setSize($dom)});function setSize($dom){var $img=$("#para-bg",$dom);setTimeout(function(){if($img.isVisible()){$img.attr("width",$dom.width());if(height){$img.attr("height",height)}else{$img.attr("height",$dom.height())}}},20)}}else{$.each(["background-image","background-repeat","filter","background"],function(idx,item){if(bg[item]!=null){$dom.css(item,bg[item])}})}}else{$.each(["background","background-size","background-image","background-repeat"],function(idx,item){if(bg[item]!=null){$dom.css(item,bg[item])
}})}},ieForFixBackground:function(){return $.browser.msie&&$.browser.version<"9.0"},contains:function(p,c){return FR.isAncestor(p,c)?true:((!p||!c)?false:p==c)},isAncestor:function(p,c){if(!p||!c){return false}if(p.contains&&!($.browser.safari||$.browser.chrome)){try{return p.contains(c)}catch(e){}}if(p.compareDocumentPosition){return !!(p.compareDocumentPosition(c)&16)}else{var parent=c.parentNode;while(parent){if(parent==p){return true}else{if(!parent.tagName||parent.tagName.toUpperCase()=="HTML"){return false
}}parent=parent.parentNode}return false}},isNavKeyPress:function(event){if(!event){return false}var safariKeys={63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35};var k=event.keyCode;k=($.browser.safari||$.browser.chrome)?(safariKeys[k]||k):k;return(k>=33&&k<=40)||k===13||k==FR.keyCode.TAB||k==FR.keyCode.ESCAPE},isSpecialKey:function(e){if(!e){return false}var k=e.keyCode;return(e.type=="keypress"&&e.ctrlKey)||k===9||k===13||k===40||k===27||(k===16)||(k===17)||(k>=18&&k<=20)||(k>=33&&k<=35)||(k>=36&&k<=39)||k===44||(k===13||k===229)
},equals:function(v1,v2){if(FR.isNull(v1)||FR.isNull(v2)){return v1==undefined&&v2==undefined||v1==null&&v2==null}if(v1===v2){return true}else{if($.isArray(v1)){if(v1.length==v2.length){for(var i=0;i<v1.length;i++){if(!FR.equals(v1[i],v2[i])){return false}}}else{return false}}else{if(typeof v1=="object"){var lv1=0,lv2=0;for(var i in v1){lv1++}for(var i in v2){lv2++}if(lv1!=lv2){return false}for(var a in v1){if(!FR.equals(v1[a],v2[a])){return false}}}else{return v1===v2}}}return true},isNull:function(v){return v==undefined||v==null
},lengthenFileName:function(name,s){if(!name){return}if(name.lastIndexOf(".")==-1){return name+s}var leftName=name.substring(0,name.lastIndexOf("."));var rightName=name.substring(name.lastIndexOf("."),name.length);return leftName+s+rightName},getCursorPosition:function(input){try{if(input.value==""){return 0}var cursurPosition=-1;if(input.selectionStart){cursurPosition=input.selectionStart}else{var rngSel=document.selection.createRange();var rngTxt=input.createTextRange();var flag=rngSel.getBookmark();
rngTxt.collapse();rngTxt.moveToBookmark(flag);rngTxt.moveStart("character",-input.value.length);cursurPosition=rngTxt.text.length}return cursurPosition}catch(e){return input.value.length}},setCursorPosition:function(input,pos){if(input.setSelectionRange){input.focus();input.setSelectionRange(pos,pos)}else{if(input.createTextRange){var lineChangeNum=input.value.length-input.value.replace(/\n/g,"").length;pos=pos-lineChangeNum+1;var range=input.createTextRange();range.collapse(true);range.moveEnd("character",pos);
range.moveStart("character",pos);range.select()}}},id2ColumnRowStr:function(id){return id.replace(/([A-Z]+\d+)-\d+-\d+/,"$1")},id2ColumnRow:function(id){return FR.cellStr2ColumnRow(FR.id2ColumnRowStr(id))},id2Location:function(id){var rt=FR.id2ColumnRow(id);var arr=id.split("-");rt.rptIdx=arr[1];return rt},cellStr2ColumnRow:function(name){name=$.trim(name.toUpperCase());if(!FR.isValidCellStr(name)){return null}var colStr=name.replace(/([A-Z]+)\d+/,"$1");var rowStr=name.replace(/[A-Z]+(\d+)/,"$1");
var col=FR.letter2Digit(colStr)-1;var row=parseInt(rowStr)-1;return{col:col,row:row}},columnRow2CellStr:function(cr){var col=parseInt(cr.col);var row=parseInt(cr.row);if(typeof col!="number"||typeof row!="number"){return""}return FR.digit2Letter(col+1)+(row+1)},isValidCellStr:function(str){if(str.match(/^[A-Z]+\d+$/)==null){return false}else{return true}},letter2Digit:function(abc){var len=abc.length;var col=0;for(var i=len-1;i>=0;i--){var c=abc.charAt(i);col+=(COL_IDS.indexOf(c)+1)*Math.pow(26,len-1-i)
}return col},digit2Letter:function(k){var c,abcBuf="";if(typeof k!="number"||k===0||isNaN(k)||!isFinite(k)){return abcBuf}for(;k!==0;){c=k%26;if(c===0){c=26}abcBuf=COL_IDS.charAt(c-1)+abcBuf;k=(k-c)/26}return abcBuf},byteLength:function(str){var byteLen=0,len=str.length;if(!str){return 0}for(var i=0;i<len;i++){byteLen+=str.charCodeAt(i)>255?2:1}return byteLen},keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},location:function(callback){callback.call(this,"fail",FR.i18nText("Fail_Location"))
}})})(jQuery);(function(b){var a={};b.shortcut=function(d,c){if(a[d]!=null){throw ("shortcut:["+d+"] has been registed")}a[d]=c;b.extend(c.prototype,{xtype:d})};FR.createWidget=function(d){if(d instanceof b){return new FR.Widget({renderEl:d})}if(d.classType){return new (new Function("return "+d.classType+";")())(d)}if(!d.type){throw ("config type cannot be null.")}var e=d.type.toLowerCase();var c=a[e];return new c(d)};b.fn.extend({asComponent:function(c){c=c||{};c.renderEl=b(this);return FR.createWidget(c)
}})})(jQuery);if(window._g==null){window._g=FR.SessionMgr.getContentPane}$.extend(FR,{string2ints:function(h){var b=[];var g=h.split(",");for(var e=0;e<g.length;e++){var d=g[e];var f=d.split("-");var a=parseInt(f[0]),c=a;if(f.length>1){c=parseInt(f[1])}for(var j=a;j<=c;j++){b.push(j)}}return b}});$.extend(FR,{activeBranches:function(branches,parameters,processid,taskName,serverURL,needClose){if(processid&&taskName){var it={id:processid,taskname:taskName}}else{var it=this.getProcessIDAndTaskName();
if(!it.processid){FR.Msg.toast(FR.i18nText("Task_Has_Been_Closed"));return}}if(!it){return}if(!$.isArray(branches)){branches=[branches]}if(parameters!=null&&!$.isArray(parameters)){parameters=[parameters]}var data=$.extend(it,{branches:branches});if(parameters){$.each(parameters,function(idx,item){if(item.value.toString().startWith("eval")){var evalValue=item.value.toString().substring(5,item.value.toString().length-1);item.value=eval(evalValue)}});data.parameters=parameters}this.ajax({url:(serverURL?serverURL:FR.servletURL)+"?op=process_exe&cmd=continue",data:data,type:"post",complete:function(res,status){if(res.responseText=="close"){FR.Msg.toast(FR.i18nText("Task_Has_Been_Closed"));
return}this.refreshUserTask(it)}.createDelegate(this)})},getProcessIDAndTaskName:function(){var a={};this.ajax({url:FR.servletURL+"?op=process_exe",async:false,data:{sessionID:FR.SessionMgr.getSessionID(),cmd:"values"},complete:function(c,b){a=FR.jsonDecode(c.responseText)}});return a},refreshUserTask:function(b){var a=window.parent;if(!a||!a.FS||!a.FS.Process){location.reload(true);return}a.FS.Process.refreshTask();var c="?op=process_exe&cmd=seejob&taskname="+b.taskname+"&processexecutorid="+b.id+"&processid="+b.processid;
a.FS.tabPane.addItem({title:FR.i18nText("Handle_Affairs")+b.id,src:c})}});/*!
 * jQuery Migrate - v1.1.1 - 2013-02-16
 * https://github.com/jquery/jquery-migrate
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT
 */
(function(s,p,i){var D={};s.migrateWarnings=[];if(!s.migrateMute&&p.console&&console.log){console.log("JQMIGRATE: Logging is active")}if(s.migrateTrace===i){s.migrateTrace=true}s.migrateReset=function(){D={};s.migrateWarnings.length=0};function h(G){if(!D[G]){D[G]=true;s.migrateWarnings.push(G);if(p.console&&console.warn&&!s.migrateMute){console.warn("JQMIGRATE: "+G);
if(s.migrateTrace&&console.trace){console.trace()}}}}function a(I,K,H,J){if(Object.defineProperty){try{Object.defineProperty(I,K,{configurable:true,enumerable:true,get:function(){h(J);return H},set:function(L){h(J);H=L}});return}catch(G){}}s._definePropertyBroken=true;I[K]=H}if(document.compatMode==="BackCompat"){h("jQuery is not compatible with Quirks Mode")}var f=s("<input/>",{size:1}).attr("size")&&s.attrFn,x=s.attr,w=s.attrHooks.value&&s.attrHooks.value.get||function(){return null},j=s.attrHooks.value&&s.attrHooks.value.set||function(){return i
},t=/^(?:input|button)$/i,y=/^[238]$/,B=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,k=/^(?:checked|selected)$/i;a(s,"attrFn",f||{},"jQuery.attrFn is deprecated");s.attr=function(K,I,L,J){var H=I.toLowerCase(),G=K&&K.nodeType;if(J){if(x.length<4){h("jQuery.fn.attr( props, pass ) is deprecated")}if(K&&!y.test(G)&&(f?I in f:s.isFunction(s.fn[I]))){return s(K)[I](L)}}if(I==="type"&&L!==i&&t.test(K.nodeName)&&K.parentNode){h("Can't change the 'type' of an input or button in IE 6/7/8")
}if(!s.attrHooks[H]&&B.test(H)){s.attrHooks[H]={get:function(N,M){var P,O=s.prop(N,M);return O===true||typeof O!=="boolean"&&(P=N.getAttributeNode(M))&&P.nodeValue!==false?M.toLowerCase():i},set:function(N,P,M){var O;if(P===false){s.removeAttr(N,M)}else{O=s.propFix[M]||M;if(O in N){N[O]=true}N.setAttribute(M,M.toLowerCase())}return M}};if(k.test(H)){h("jQuery.fn.attr('"+H+"') may use property instead of attribute")}}return x.call(s,K,I,L)};s.attrHooks.value={get:function(H,G){var I=(H.nodeName||"").toLowerCase();
if(I==="button"){return w.apply(this,arguments)}if(I!=="input"&&I!=="option"){h("jQuery.fn.attr('value') no longer gets properties")}return G in H?H.value:null},set:function(G,H){var I=(G.nodeName||"").toLowerCase();if(I==="button"){return j.apply(this,arguments)}if(I!=="input"&&I!=="option"){h("jQuery.fn.attr('value', val) no longer sets properties")}G.value=H}};var q,E,z=s.fn.init,A=s.parseJSON,v=/^(?:[^<]*(<[\w\W]+>)[^>]*|#([\w\-]*))$/;s.fn.init=function(G,J,I){var H;if(G&&typeof G==="string"&&!s.isPlainObject(J)&&(H=v.exec(G))&&H[1]){if(G.charAt(0)!=="<"){h("$(html) HTML strings must start with '<' character")
}if(J&&J.context){J=J.context}if(s.parseHTML){return z.call(this,s.parseHTML(s.trim(G),J,true),J,I)}}return z.apply(this,arguments)};s.fn.init.prototype=s.fn;s.parseJSON=function(G){if(!G&&G!==null){h("jQuery.parseJSON requires a valid JSON string");return null}return A.apply(this,arguments)};s.uaMatch=function(H){H=H.toLowerCase();var G=/(chrome)[ \/]([\w.]+)/.exec(H)||/(webkit)[ \/]([\w.]+)/.exec(H)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(H)||/(msie) ([\w.]+)/.exec(H)||H.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(H)||[];
return{browser:G[1]||"",version:G[2]||"0"}};if(!s.browser){q=s.uaMatch(navigator.userAgent);E={};if(q.browser){E[q.browser]=true;E.version=q.version}if(E.chrome){E.webkit=true}else{if(E.webkit){E.safari=true}}s.browser=E}a(s,"browser",s.browser,"jQuery.browser is deprecated");s.sub=function(){function G(J,K){return new G.fn.init(J,K)}s.extend(true,G,this);G.superclass=this;G.fn=G.prototype=this();G.fn.constructor=G;G.sub=this.sub;G.fn.init=function I(J,K){if(K&&K instanceof s&&!(K instanceof G)){K=G(K)
}return s.fn.init.call(this,J,K,H)};G.fn.init.prototype=G.fn;var H=G(document);h("jQuery.sub() is deprecated");return G};s.ajaxSetup({converters:{"text json":s.parseJSON}});var n=s.fn.data;s.fn.data=function(I){var H,G,J=this[0];if(J&&I==="events"&&arguments.length===1){H=s.data(J,I);G=s._data(J,I);if((H===i||H===G)&&G!==i){h("Use of jQuery.fn.data('events') is deprecated");return G}}return n.apply(this,arguments)};var o=/\/(java|ecma)script/i,u=s.fn.andSelf||s.fn.addBack;s.fn.andSelf=function(){h("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()");
return u.apply(this,arguments)};if(!s.clean){s.clean=function(G,H,N,J){H=H||document;H=!H.nodeType&&H[0]||H;H=H.ownerDocument||H;h("jQuery.clean() is deprecated");var K,I,L,O,M=[];s.merge(M,s.buildFragment(G,H).childNodes);if(N){L=function(P){if(!P.type||o.test(P.type)){return J?J.push(P.parentNode?P.parentNode.removeChild(P):P):N.appendChild(P)}};for(K=0;(I=M[K])!=null;K++){if(!(s.nodeName(I,"script")&&L(I))){N.appendChild(I);if(typeof I.getElementsByTagName!=="undefined"){O=s.grep(s.merge([],I.getElementsByTagName("script")),L);
M.splice.apply(M,[K+1,0].concat(O));K+=O.length}}}}return M}}var c=s.event.add,b=s.event.remove,g=s.event.trigger,r=s.fn.toggle,d=s.fn.live,m=s.fn.die,C="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",e=new RegExp("\\b(?:"+C+")\\b"),F=/(?:^|\s)hover(\.\S+|)\b/,l=function(G){if(typeof(G)!=="string"||s.event.special.hover){return G}if(F.test(G)){h("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'")}return G&&G.replace(F,"mouseenter$1 mouseleave$1")};if(s.event.props&&s.event.props[0]!=="attrChange"){s.event.props.unshift("attrChange","attrName","relatedNode","srcElement")
}if(s.event.dispatch){a(s.event,"handle",s.event.dispatch,"jQuery.event.handle is undocumented and deprecated")}s.event.add=function(J,H,I,K,G){if(J!==document&&e.test(H)){h("AJAX events should be attached to document: "+H)}c.call(this,J,l(H||""),I,K,G)};s.event.remove=function(K,I,J,G,H){b.call(this,K,l(I)||"",J,G,H)};s.fn.error=function(){var G=Array.prototype.slice.call(arguments,0);h("jQuery.fn.error() is deprecated");G.splice(0,0,"error");if(arguments.length){return this.bind.apply(this,G)}this.triggerHandler.apply(this,G);
return this};s.fn.toggle=function(K,I){if(!s.isFunction(K)||!s.isFunction(I)){return r.apply(this,arguments)}h("jQuery.fn.toggle(handler, handler...) is deprecated");var H=arguments,G=K.guid||s.guid++,J=0,L=function(M){var N=(s._data(this,"lastToggle"+K.guid)||0)%J;s._data(this,"lastToggle"+K.guid,N+1);M.preventDefault();return H[N].apply(this,arguments)||false};L.guid=G;while(J<H.length){H[J++].guid=G}return this.click(L)};s.fn.live=function(G,I,H){h("jQuery.fn.live() is deprecated");if(d){return d.apply(this,arguments)
}s(this.context).on(G,this.selector,I,H);return this};s.fn.die=function(G,H){h("jQuery.fn.die() is deprecated");if(m){return m.apply(this,arguments)}s(this.context).off(G,this.selector||"**",H);return this};s.event.trigger=function(I,J,H,G){if(!H&&!e.test(I)){h("Global events are undocumented and deprecated")}return g.call(this,I,J,H||document,G)};s.each(C.split("|"),function(H,G){s.event.special[G]={setup:function(){var I=this;if(I!==document){s.event.add(document,G+"."+s.guid,function(){s.event.trigger(G,null,I,true)
});s._data(this,G,s.guid++)}return false},teardown:function(){if(this!==document){s.event.remove(document,G+"."+s._data(this,G))}return false}}})})(jQuery,window);(function(a){a.extend(FR,{_numberFormat:function(z,h){if("#.##"==h||"#.##%"==h||"#,###.##%"==h){return FR._numberUse4Chart(z,h)}var u=h.split(" ");if(u.length>=2&&u[u.length-1].startWith("#")){var s=u[u.length-1];return h.substring(0,h.length-s.length)+FR._numberFormat(z,s)}if(h.indexOf(";")>=0){if(z>=0){return FR._numberFormat(z+"",h.substring(0,h.indexOf(";")))}else{return FR._numberFormat((-z)+"",h.substring(h.indexOf(";")+1))}}var F="";var f=false;if(h.match(/,/)&&h.match(/#,/)){f=true}var k=h.split(".");
if(!isNaN(z)&&z.indexOf("e")!=-1){var S=z.substring(z.indexOf("e")+1,z.length);if(S&&S.length>0&&Number(S)<0){z=Number(z).toFixed(Math.abs(S))}}var R=z.split(".");var j=false;if(R.length>1&&k.length<=1){var L=R[1].split("");if(L&&L.length>0){var C=L[0].length>0?L[0]:0;j=C>4}}var p=j?(parseInt(R[0])+1).toString().split(""):R[0].split("");var l=k[0].split("");var Q=k[0].split("");var t="";var K="";var y=[];for(var J=0;J<l.length;J++){var q=l[J];if(q=="#"||q=="0"){y.push(J)}}if(p[0]&&p[0].length>0){var M=p.length-1;
var A=0;for(var J=y.length-1;J>=0;J--){A++;var e=y[J];l[e]=p[M];if(M===0){break}M--}var r=y[0];if(Q[r]=="#"){if(p.length>A){var O=p.length-A;for(var J=0;J<O;J++){t+=p[J]}l[r]=t+l[r]}}}if(r>0){F=l.join("").substring(0,r)}if(k[1]&&k[1].length>0){var E=k[1].split("");var g=k[1].split("");if(R[1]&&R[1].length>0){var H=R[1].split("");var x=[];for(var J=0;J<E.length;J++){var q=E[J];if(q=="#"||q=="0"){x.push(J)}}var A=0;if(k[1].indexOf("#")==-1){var b=0;b=parseInt(H.join(""),10);b=Math.round(b/Math.pow(10,H.length-x.length));
b=String(b);var m=b.length;for(var J=0;J<x.length-m;J++){b="0"+b}l=l.join("").split("");if(b.length==x.length+1){var c=[];var I=[];var P=0;for(var J=0;J<l.length;J++){if(!(l[J]>="0"&&l[J]<="9")){P++}else{break}}for(var J=P;J<l.length;J++){c.push(l[J])}for(var J=0;J<P;J++){I.push(l[J])}l=I.join("")+String(c.length===0?1:(parseInt(c.join(""))+1));l=l.split("")}for(var J=b.length-1;J>=b.length-x.length;J--){A++;var e=x[J];E[e]=b.charAt(J)}}else{for(var J=0;J<x.length;J++){A++;var e=x[J];E[e]=H[J];if(J==H.length-1){break
}}}var d=x[x.length-1];if(g[d]=="#"){for(var J=A;J<H.length;J++){K+=H[J]}E[d]+=K}}}for(var J=0;J<l.length;J++){if(l[J]=="#"){l[J]=""}}var o=l.join("");if(k[1]){for(var J=0;J<E.length;J++){if(E[J]=="#"){E[J]=""}}if(!(R[1])&&g[0]=="#"){o+=E.join("")}else{o+="."+E.join("")}}var B=y[0];var G=o;o=o.substring(B,o.length);if(o.substring(0,1)==","){o=o.substring(1)}o=G.substring(0,B)+o;if(o.substring(1,2)==","&&isNaN(o.substring(0,1))){o=o.substring(0,1)+o.substring(2)}if(z.substring(0,1)=="-"&&!isNaN(o.substring(0,1))){o="-"+o
}if(o.substring(o.length-1)==","){o=o.substring(0,o.length)}if(f){var N=[];F&&(o=o.substring(1,o.length));var n=o.split(",");if(n.length===1){N.push(n[0]);return F+N.join(",")}N.unshift(o.split(",")[1]);var D="";for(var J=0;J<h.length;J++){var w=h.charAt(J);if(w=="#"||w==","||w==="0"){D+=w}else{if(w==="."){break}}}N.unshift(FR._numberFormat(n[0],D));return N.join(",")}return o},_numberUse4Chart:function(d,b){var c=d;if(b.endWith("%")){c=FR.contentFormat(d,"#0.00%");if(c.endWith(".00%")){c=c.substring(0,c.length-4)+"%"
}else{if(c.endWith(".0%")){c=c.substring(0,c.length-3)+"%"}}}else{c=FR._numberFormat(d,"#0.00");if(c.endWith(".00")){c=c.substring(0,c.length-3)}else{if(c.endWith(".0")){c=c.substring(0,c.length-2)}else{if(c.endWith("0")&&c.match(/.*\.\d/)){c=c.substring(0,c.length-1)}}}}return c},contentFormat:function(e,d){if(e==null||e===""){return""}if(d==null){return e+""}var h=e.toString();if(d.match(/^T/)){return h}else{if(d.match(/0(\.0*)?%$/)){var c=e+"";var b=c.indexOf(".");if(b>=0){c=Number(c.replace(".",""))/Math.pow(10,c.length-b-3)
}else{c=e*10*10}h=FR.contentFormat(c,d.substring(0,d.length-1))+"%"}else{if((d.match(/^D/))){if(!(e instanceof Date)){if(!isNaN(e)){var g=e;e=new Date(e);if(FR.isInvalidDate(e)){e=FR.dealWithDateWithoutSeparator(d,g)}}else{e=Date.parseDate(e+"",Date.patterns.ISO8601Long)}}if(e!=null){var f=d.match(/^DT/);h=""+FR.date2Str(e,d.substring(f?2:1));if(f&&h.endWith("00:00:00")){h=h.substring(0,h.length-9)}h=FR.CNDateString(h)}}else{h=FR._numberFormat(h,d)}}}if(d.match(/¡è/)){h=h.replace(/¡è/g,"£¤")}else{if(d.match(/E/)&&!(d.match(/EEEE/))){h=FR._ENumberFormat(e,d)
}}return h},_ENumberFormat:function(n,m){if(m.indexOf(";")>=0){if(n>=0){return FR._ENumberFormat(n+"",m.substring(0,m.indexOf(";")))}else{return FR._ENumberFormat((-n)+"",m.substr(m.indexOf(";")+1))}}var h=m.indexOf("E");var j=m.toString();var c=j.slice(0,h);var p=j.slice(h+1);if(n===0){n=0}var k=0;var d=n.toString();var o;if(d.indexOf(".")==-1){o=d.length}else{o=d.slice(0,d.indexOf(".")).length}var l;if(c.indexOf(".")==-1){l=c.length}else{l=c.slice(0,c.indexOf(".")).length;for(var g=0;g<l;g++){if(c.charAt(g)!="#"&&c.charAt(g)!="0"){l--
}else{break}}}k=Math.abs(o-l);if(n<0){o-=1;k-=1}var n=n*Math.pow(10,l-o);var b=FR.contentFormat(n.toString(),c);var f=FR._numberFormat(k.toString(),p);return b+"E"+f},CNDateString:function(b){b=b.replace(/Jan/,FR.i18nText("January"));b=b.replace(/Feb/,FR.i18nText("February"));b=b.replace(/Mar/,FR.i18nText("March"));b=b.replace(/Apr/,FR.i18nText("April"));b=b.replace(/May/,FR.i18nText("May"));b=b.replace(/Jun/,FR.i18nText("June"));b=b.replace(/Jul/,FR.i18nText("July"));b=b.replace(/Aug/,FR.i18nText("August"));
b=b.replace(/Sep/,FR.i18nText("September"));b=b.replace(/Oct/,FR.i18nText("October"));b=b.replace(/Nov/,FR.i18nText("November"));b=b.replace(/Dec/,FR.i18nText("December"));b=b.replace(/Monday/,FR.i18nText("Sche-Monday"));b=b.replace(/Tuesday/,FR.i18nText("Sche-Tuesday"));b=b.replace(/Wednesday/,FR.i18nText("Sche-Wednesday"));b=b.replace(/Thursday/,FR.i18nText("Sche-Thursday"));b=b.replace(/Friday/,FR.i18nText("Sche-Friday"));b=b.replace(/Saturday/,FR.i18nText("Sche-Saturday"));b=b.replace(/Sunday/,FR.i18nText("Sche-Sunday"));
return b},object2Number:function(b){if(b==null){return 0}if(typeof b=="number"){return b}else{var c=b+"";if(c.indexOf(".")===-1){return parseInt(c)}else{return parseFloat(c)}}},object2Date:function(c){if(c==null){return new Date()}if(c instanceof Date){return c}else{if(typeof c=="number"){return new Date(c)}else{var d=c+"";d=d.replace(/-/g,"/");var b=new Date(d);if(!FR.isInvalidDate(b)){return b}return new Date()}}},object2Time:function(c){if(c==null){return new Date()}if(c instanceof Date){return c
}else{var d=c+"";d=d.replace(/-/g,"/");var b=new Date(d);if(!FR.isInvalidDate(b)){return b}if(d.indexOf("/")===-1&&d.indexOf(":")!==-1){b=new Date("1970/01/01 "+d);if(!FR.isInvalidDate(b)){return b}}b=FR.str2Date(d,"HH:mm:ss");if(!FR.isInvalidDate(b)){return b}return new Date()}},dealWithDateWithoutSeparator:function(b,c){if(FR.isEmpty(b)||FR.isEmpty(c)){return}if(typeof b!="string"||typeof(c)!="string"){return}if(b.indexOf("-")!=-1||b.indexOf("/")!=-1){return}var d;if(b.indexOf("yyyyMMdd")!=-1){d=new Date(c.substring(0,4)+"-"+c.substring(4,6)+"-"+c.substring(6,8));
if(FR.isInvalidDate(d)){d=new Date(c.substring(0,4)+"/"+c.substring(4,6)+"/"+c.substring(6,8))}return d}else{if(b.indexOf("MMddyyyy")!=-1){d=new Date(c.substring(0,2)+"-"+c.substring(2,4)+"-"+c.substring(4,8));if(FR.isInvalidDate(d)){d=new Date(c.substring(0,2)+"/"+c.substring(2,4)+"/"+c.substring(4,8))}return d}}},isInvalidDate:function(b){return b=="Invalid Date"||b=="NaN"}})})(jQuery);$.extend(Date.prototype,{getTimezone:function(){return this.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getLastDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),this.getMonthDays())},getMonthDays:function(c){var b=[31,28,31,30,31,30,31,31,30,31,30,31];var a=this.getFullYear();if(typeof c=="undefined"){c=this.getMonth()}if(((0===(a%4))&&((0!==(a%100))||(0===(a%400))))&&c===1){return 29}else{return b[c]}},getWeekNumber:function(){var c=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);
var b=c.getDay();c.setDate(c.getDate()-(b+6)%7+3);var a=c.valueOf();c.setMonth(0);c.setDate(4);return Math.round((a-c.valueOf())/(7*86400000))+1}});(function(){var compileJFmt=function(jfmt,date){var str=jfmt.str,len=jfmt.len,ch=jfmt["char"];switch(ch){case"E":str=Date._DN[date.getDay()];break;case"y":if(len<=3){str=(date.getFullYear()+"").slice(2,4)}else{str=date.getFullYear()}break;case"M":if(len>2){str=Date._MN[date.getMonth()]}else{if(len<2){str=date.getMonth()+1}else{str=String.leftPad(date.getMonth()+1+"",2,"0")
}}break;case"d":if(len>1){str=String.leftPad(date.getDate()+"",2,"0")}else{str=date.getDate()}break;case"h":var hour=date.getHours()%12;if(hour===0){hour=12}if(len>1){str=String.leftPad(hour+"",2,"0")}else{str=hour}break;case"H":if(len>1){str=String.leftPad(date.getHours()+"",2,"0")}else{str=date.getHours()}break;case"m":if(len>1){str=String.leftPad(date.getMinutes()+"",2,"0")}else{str=date.getMinutes()}break;case"s":if(len>1){str=String.leftPad(date.getSeconds()+"",2,"0")}else{str=date.getSeconds()
}break;case"a":str=date.getHours()<12?"am":"pm";break;case"z":str=date.getTimezone();break;default:str=jfmt.str;break}return str};FR.parseFmt=function(fmt){if(!fmt){return""}fmt=String(fmt).replace(/y{4,}/g,"%Y").replace(/y{2}/g,"%y").replace(/M{4,}/g,"%b").replace(/M{3}/g,"%B").replace(/M{2}/g,"%X").replace(/M{1}/g,"%x").replace(/a{1}/g,"%p");if(new RegExp("d{2,}","g").test(fmt)){fmt=fmt.replace(/d{2,}/g,"%d")}else{fmt=fmt.replace(/d{1}/g,"%e")}if(new RegExp("h{2,}","g").test(fmt)){fmt=fmt.replace(/h{2,}/g,"%I")
}else{fmt=fmt.replace(/h{1}/g,"%I")}if(new RegExp("H{2,}","g").test(fmt)){fmt=fmt.replace(/H{2,}/g,"%H")}else{fmt=fmt.replace(/H{1}/g,"%H")}fmt=fmt.replace(/m{2,}/g,"%M").replace(/s{2,}/g,"%S");return fmt};FR.matchDateFormat=function(date,format){if(typeof date!="string"||typeof format!="string"||!date||!format){return false}var zh_yMd="["+String.fromCharCode(24180)+String.fromCharCode(26376)+String.fromCharCode(26085)+"]";if(date.match(zh_yMd)){if(format.match(zh_yMd)){date=date.replaceAll(zh_yMd,"-");
format=format.replaceAll(zh_yMd,"-");if(date.endWith("-")&&format.endWith("-")){date=date.substring(0,date.length-1);format=format.substring(0,format.length-1)}}else{return false}}else{if(format.match(zh_yMd)){return false}}var isAM=null;if(format.endWith(" a")){format=format.substring(0,format.length-2);if(date.endWith(" am")||date.endWith(" pm")){isAM=date.endWith(" am");date=date.substring(0,date.length-3)}else{return false}}if(date.replace(/[0-9]/g,"")!=format.replace(/[YyMmDdHhSsa]/g,"")){return false
}var formatStr=format;var dateStr=date;var formatArr=[];var dateArr=[];if(format.indexOf(" ")==-1){dateArr=shortMatch(dateStr,formatStr);if(!dateArr){return false}}else{var ff=format.split(" ");var dd=date.split(" ");for(var i=0;i<ff.length;i++){var temp=shortMatch(dd[i],ff[i]);if(!temp){return false}else{dateArr=dateArr.concat(temp)}}}function shortMatch(str,fmt){var da=[];var fa=[];if(fmt.match(/[-/:.]/)){fa=fmt.split(/[-/:.]/);formatArr=formatArr.concat(fa);var da=str.split(/[-/:.]/);return da
}while(fmt.length>0){var reg=new RegExp(fmt.substring(0,1)+"+");var f=fmt.match(reg).toString();fa.push(f);formatArr.push(f);fmt=fmt.substring(f.length)}var len=0;for(var i=0;i<fa.length;i++){var tmpLen=0;if(fa[i].length===1){if(i==fa.length-1){tmpLen=str.length-len}else{if(i==fa.length-2){switch(str.length-len){case 2:tmpLen=1;break;case 3:if(invalidStr(str.substring(len,len+2),fa[i])||fa[i+1].length===2){tmpLen=1}else{if(fa[i+1].length===1&&invalidStr(str.substring(len+1,len+3),fa[i+1])){tmpLen=2
}else{tmpLen=1}}break;case 4:tmpLen=2;break;default:return false}}}}else{tmpLen=fa[i].length}da[i]=str.substring(len,len+tmpLen);len+=tmpLen}return da}function invalidStr(str,fm){return str.match(/[Mh]/)&&parseInt(fm,10)>12||str.match(/[d]/)&&parseInt(fm,10)>31||str.match(/[H]/)&&parseInt(fm,10)>23||str.match(/[ms]/)&&parseInt(fm,10)>59}if(formatArr.length!=dateArr.length){return false}else{for(var i=0;i<formatArr.length;i++){var ff=formatArr[i].replace(/ /g,"");var vv=dateArr[i].replace(/ /g,"");
if(ff.length===1&&((vv.length===2&&vv.startWith("0"))||vv.length>2)||ff.length===2&&vv.length!==2||ff.length===4&&vv.length!==4){return false}}var que=["y","M","d","h","H","m","s"];for(var i=0;i<formatArr.length;i++){if(formatArr[i].match(/[yMd]/)){for(var j=i+1;j<formatArr.length;j++){if(formatArr[j].match(/[yMd]/)&&que.indexOf(formatArr[i].substring(0,1))>que.indexOf(formatArr[j].substring(0,1))){var tmp=formatArr[i];formatArr[i]=formatArr[j];formatArr[j]=tmp;tmp=dateArr[i];dateArr[i]=dateArr[j];
dateArr[j]=tmp}}}}if(!format.match(/[hHms]/)){var dt="";for(var i=0;i<dateArr.length;i++){var yMd=formatArr[i]=="yy"?"20"+dateArr[i]:dateArr[i];dt=dt.length===0?yMd:dt+"/"+yMd}var res=new Date(dt);if(!FR.isInvalidDate(res)){if(!inMonthRange(res)){return false}return res}else{if(!FR.isInvalidDate(new Date(dt+"/01"))){return new Date(dt+"/01")}else{if(!FR.isInvalidDate(new Date(dt+"/01/01"))){return new Date(dt+"/01/01")}}}}else{var dt="";var spt=false;for(var i=0;i<formatArr.length;i++){if(formatArr[i].match(/[yMd]/)){var yMd=formatArr[i]=="yy"?"20"+dateArr[i]:dateArr[i];
dt=dt.length===0?yMd:dt+"/"+yMd}else{var hms=dateArr[i];if(formatArr[i].indexOf("h")!=-1&&isAM===false&&parseInt(hms)<12){hms=parseInt(hms)+12}if(!spt){dt=dt+" "+hms;spt=true}else{dt=dt+":"+hms}}}var res=new Date(dt);if(!inMonthRange(res)){return false}return res}}function inMonthRange(res){var d,m;for(var i=0;i<formatArr.length;i++){if(formatArr[i].indexOf("d")!=-1){d=dateArr[i].replace(/^[0]/,"")}else{if(formatArr[i].indexOf("M")!=-1){m=dateArr[i].replace(/^[0]/,"")}}}if(d==null||m==null){return true
}return parseInt(d)==res.getDate()&&parseInt(m)==res.getMonth()+1}};FR.str2Date=function(str,format){if(typeof str!="string"||typeof format!="string"){return null}var fmt=FR.parseFmt(format);return Date.parseDateTime(str,fmt)};FR.date2Str=function(date,format){if(!date){return""}var len=format.length,result="";if(len>0){var flagch=format.charAt(0),start=0,str=flagch;for(var i=1;i<len;i++){var ch=format.charAt(i);if(flagch!==ch){result+=compileJFmt({"char":flagch,str:str,len:i-start},date);flagch=ch;
start=i;str=flagch}else{str+=ch}}result+=compileJFmt({"char":flagch,str:str,len:len-start},date)}return result};Date.patterns={ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"};Date.parseFunctions={count:0};Date.parseRegexes=[];Date.formatFunctions={count:0};Date._MN=[FR.i18nText("January"),FR.i18nText("February"),FR.i18nText("March"),FR.i18nText("April"),FR.i18nText("May"),FR.i18nText("June"),FR.i18nText("July"),FR.i18nText("August"),FR.i18nText("September"),FR.i18nText("October"),FR.i18nText("November"),FR.i18nText("December")];
Date._SMN=[FR.i18nText("Short-Jan"),FR.i18nText("Short-Feb"),FR.i18nText("Short-Mar"),FR.i18nText("Short-Apr"),FR.i18nText("Short-May"),FR.i18nText("Short-Jun"),FR.i18nText("Short-Jul"),FR.i18nText("Short-Aug"),FR.i18nText("Short-Sep"),FR.i18nText("Short-Oct"),FR.i18nText("Short-Nov"),FR.i18nText("Short-Dec")];Date._DN=[FR.i18nText("Sche-Sunday"),FR.i18nText("Sche-Monday"),FR.i18nText("Sche-Tuesday"),FR.i18nText("Sche-Wednesday"),FR.i18nText("Sche-Thursday"),FR.i18nText("Sche-Friday"),FR.i18nText("Sche-Saturday")];
Date._SDN=[FR.i18nText("Sun"),FR.i18nText("Mon"),FR.i18nText("Tue"),FR.i18nText("Wed"),FR.i18nText("Thu"),FR.i18nText("Fri"),FR.i18nText("Sat")];Date.y2kYear=50;Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.getMonthNumber=function(name){return Date.monthNumbers[name.substring(0,1).toUpperCase()+name.substring(1,3).toLowerCase()]};Date.parseDate=function(input,format){if(Date.parseFunctions[format]==null){Date.createParser(format)}var func=Date.parseFunctions[format];
return Date[func](input)};Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++;var regexNum=Date.parseRegexes.length;var currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input){\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, ms = -1, o, z, u, v;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {";
var regex="";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;regex+=String.escape(ch)}else{var obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g;regex+=obj.s;if(obj.g&&obj.c){code+=obj.c}}}}code+="if (u)\n{v = new Date(u * 1000);}else if (y >= 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0 && ms >= 0)\n{v = new Date(y, m, d, h, i, s, ms);}\nelse if (y >= 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{v = new Date(y, m, d, h, i, s);}\nelse if (y >= 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{v = new Date(y, m, d, h, i);}\nelse if (y >= 0 && m >= 0 && d > 0 && h >= 0)\n{v = new Date(y, m, d, h);}\nelse if (y >= 0 && m >= 0 && d > 0)\n{v = new Date(y, m, d);}\nelse if (y >= 0 && m >= 0)\n{v = new Date(y, m);}\nelse if (y >= 0)\n{v = new Date(y);}\n}return (v && (z || o))?\n    (z ? v.add(Date.SECOND, (v.getTimezoneOffset() * 60) + (z*1)) :\n        v.add(Date.HOUR, (v.getGMTOffset() / 100) + (o / -100))) : v\n;}";
Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$","i");eval(code)};Date.parseDateTime=function(str,fmt){var today=new Date();var y=0;var m=0;var d=1;var a=str.split(/\W+/);if(fmt.toLowerCase()=="%y%x"||fmt.toLowerCase()=="%y%x%d"){var tempStr=a.join("");var yearlength=4;var otherlength=2;a[0]=tempStr.substring(0,yearlength);a[1]=tempStr.substring(yearlength,yearlength+otherlength);a[2]=tempStr.substring(yearlength+otherlength,yearlength+otherlength*2)}var b=fmt.match(/%./g);var i=0,j=0;var hr=0;
var min=0;var sec=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%X":m=parseInt(a[i],10)-1;break;case"%x":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":for(j=0;j<12;++j){if(Date._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12
}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);case"%S":sec=parseInt(a[i],10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(isNaN(sec)){sec=today.getSeconds()}if(y!==0){return new Date(y,m,d,hr,min,sec)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Date._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;
break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y===0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d===0){d=a[i]}}}}}if(y===0){y=today.getFullYear()}if(m!==-1&&d!==0){return new Date(y,m,d,hr,min,sec)}return today};Date.formatCodeToRegex=function(character,currentGroup){switch(character){case"d":return{g:1,c:"d = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"D":for(var a=[],i=0;i<7;a.push(Date._SDN[i]),++i){}return{g:0,c:null,s:"(?:"+a.join("|")+")"};
case"j":return{g:1,c:"d = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"N":return{g:0,c:null,s:"[1-7]"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"[0-6]"};case"z":return{g:0,c:null,s:"(?:\\d{1,3}"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.getMonthNumber(results["+currentGroup+"]), 10);\n",s:"("+Date._MN.join("|")+")"};case"m":return{g:1,c:"m = parseInt(results["+currentGroup+"], 10) - 1;\n",s:"(\\d{2})"};
case"M":for(var a=[],i=0;i<12;a.push(Date._SMN[i]),++i){}return{g:1,c:"m = parseInt(Date.getMonthNumber(results["+currentGroup+"]), 10);\n",s:"("+a.join("|")+")"};case"n":return{g:1,c:"m = parseInt(results["+currentGroup+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"(?:\\d{2})"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"o":case"Y":return{g:1,c:"y = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+currentGroup+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};
case"a":return{g:1,c:"if (results["+currentGroup+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+currentGroup+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":return{g:1,c:"h = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{1,2})"};case"h":case"H":return{g:1,c:"h = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"i":return{g:1,c:"i = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};
case"s":return{g:1,c:"s = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{2})"};case"u":return{g:1,c:"ms = parseInt(results["+currentGroup+"], 10);\n",s:"(\\d{3})"};case"O":return{g:1,c:["o = results[",currentGroup,"];\n","var sn = o.substring(0,1);\n","var hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60);\n","var mn = o.substring(3,5) % 60;\n","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))?\n","    (sn + String.leftPad(hr, 2, 0) + String.leftPad(mn, 2, 0)) : null;\n"].join(""),s:"([+\\-]\\d{4})"};
case"P":return{g:1,c:["o = results[",currentGroup,"];\n","var sn = o.substring(0,1);\n","var hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60);\n","var mn = o.substring(4,6) % 60;\n","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))?\n","    (sn + String.leftPad(hr, 2, 0) + String.leftPad(mn, 2, 0)) : null;\n"].join(""),s:"([+\\-]\\d{2}:\\d{2})"};case"T":return{g:0,c:null,s:"[A-Z]{1,4}"};case"Z":return{g:1,c:"z = results["+currentGroup+"] * 1;\nz = (-43200 <= z && z <= 50400)? z : null;\n",s:"([+\\-]?\\d{1,5})"};
case"c":var df=Date.formatCodeToRegex,calc=[];var arr=[df("Y",1),df("m",2),df("d",3),df("h",4),df("i",5),df("s",6),df("P",7)];for(var i=0,l=arr.length;i<l;++i){calc.push(arr[i].c)}return{g:1,c:calc.join(""),s:arr[0].s+"-"+arr[1].s+"-"+arr[2].s+"T"+arr[3].s+":"+arr[4].s+":"+arr[5].s+arr[6].s};case"U":return{g:1,c:"u = parseInt(results["+currentGroup+"], 10);\n",s:"(-?\\d+)"};default:return{g:0,c:null,s:character.replace(/([.*+?^$}{()|[\]\/\\])/g,"\\$1")}}};if($.browser.safari){Date.brokenSetMonth=Date.prototype.setMonth;
Date.prototype.setMonth=function(num){if(num<=-1){var n=Math.ceil(-num);var back_year=Math.ceil(n/12);var month=(n%12)?12-n%12:0;this.setFullYear(this.getFullYear()-back_year);return Date.brokenSetMonth.call(this,month)}else{return Date.brokenSetMonth.apply(this,arguments)}}}})();


